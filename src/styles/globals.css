@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== Apple Design System - SF Pro Font Stack ===== */
@layer base {
  :root {
    /* SF Pro 字体系统 */
    --font-sans: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", "Segoe UI", Roboto, sans-serif;
    --font-mono: "SF Mono", SFMono-Regular, ui-monospace, Menlo, Monaco, "Cascadia Code", monospace;
    
    /* ===== Apple Light Mode 配色 (优化对比度) ===== */
    
    /* 背景层次 - 增加层级对比度 */
    --background: 0 0% 100%;
    --background-secondary: 220 14% 96%;    /* 带轻微蓝灰调，更明显的区分 */
    --background-tertiary: 220 13% 93%;     /* 进一步加深 */
    --foreground: 0 0% 9%;                  /* 稍微柔和的黑色 */
    --foreground-secondary: 0 0% 32%;
    --foreground-tertiary: 0 0% 46%;
    
    /* 卡片 - 纯白底，与灰色背景形成对比 */
    --card: 0 0% 100%;
    --card-foreground: 0 0% 9%;
    
    /* 弹出层 */
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 9%;
    
    /* Apple 系统蓝 #007AFF */
    --primary: 211 100% 50%;
    --primary-foreground: 0 0% 100%;
    --primary-hover: 211 100% 45%;
    
    /* 次要色 - 更明显的灰色 */
    --secondary: 220 14% 93%;
    --secondary-foreground: 0 0% 20%;
    
    /* 静音色 */
    --muted: 220 14% 94%;
    --muted-foreground: 0 0% 46%;
    
    /* 强调色 */
    --accent: 220 14% 94%;
    --accent-foreground: 0 0% 20%;
    
    /* Apple 系统红 #FF3B30 */
    --destructive: 4 100% 59%;
    --destructive-foreground: 0 0% 100%;
    
    /* Apple 系统绿 #34C759 */
    --success: 142 70% 49%;
    --success-foreground: 0 0% 100%;
    
    /* Apple 系统橙 #FF9500 */
    --warning: 35 100% 50%;
    --warning-foreground: 0 0% 100%;
    
    /* Apple 系统黄 #FFCC00 */
    --info: 48 100% 50%;
    --info-foreground: 0 0% 0%;
    
    /* 边框 - 增强可见度 */
    --border: 220 13% 86%;                  /* 更深的边框 */
    --border-secondary: 220 13% 80%;
    --input: 220 13% 86%;
    --ring: 211 100% 50%;
    
    /* Zed + Apple 圆角系统 - 更紧凑的圆角（基于 1rem = 16px） */
    --radius-xs: 0.1875rem;
    --radius-sm: 0.25rem;
    --radius: 0.375rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.625rem;
    --radius-xl: 0.875rem;
    --radius-2xl: 1.125rem;
    --radius-3xl: 1.375rem;
    --radius-full: 9999px;
    
    /* 侧边栏 - 与主背景区分开 */
    --sidebar: 220 14% 96%;
    --sidebar-foreground: 0 0% 9%;
    --sidebar-border: 220 13% 86%;
    --sidebar-accent: 211 100% 50%;
    --sidebar-accent-foreground: 0 0% 100%;
    --sidebar-muted: 0 0% 46%;
    
    /* 标题栏 */
    --titlebar: 220 14% 97%;
    --titlebar-foreground: 0 0% 9%;
    --titlebar-border: 220 13% 88%;
    
    /* Zed + Apple 阴影系统 - 适度增强（基于 1rem = 16px） */
    --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.06);
    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
    --shadow: 0 2px 6px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.06);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0, 0, 0, 0.06);
    --shadow-xl: 0 16px 32px rgba(0, 0, 0, 0.14), 0 8px 16px rgba(0, 0, 0, 0.08);
    
    /* 玻璃态 */
    --glass-bg: rgba(255, 255, 255, 0.78);
    --glass-border: rgba(0, 0, 0, 0.06);
    --glass-blur: 20px;
    --glass-saturate: 180%;
    
    /* 动画时长 */
    --duration-fast: 150ms;
    --duration-normal: 250ms;
    --duration-slow: 350ms;
    
    /* Apple 弹簧动画曲线 */
    --ease-default: cubic-bezier(0.25, 0.1, 0.25, 1);
    --ease-in: cubic-bezier(0.42, 0, 1, 1);
    --ease-out: cubic-bezier(0, 0, 0.58, 1);
    --ease-in-out: cubic-bezier(0.42, 0, 0.58, 1);
    --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
    --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    
    /* 间距系统 - 4px 基础网格 */
    --space-0: 0;
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 20px;
    --space-6: 24px;
    --space-8: 32px;
    --space-10: 40px;
    --space-12: 48px;
    --space-16: 64px;
  }

  /* ===== Apple Dark Mode 配色 ===== */
  .dark {
    /* 背景层次 - Apple 深色不是纯黑 */
    --background: 0 0% 0%;
    --background-secondary: 0 0% 7%;
    --background-tertiary: 0 0% 11%;
    --foreground: 0 0% 100%;
    --foreground-secondary: 0 0% 85%;
    --foreground-tertiary: 0 0% 60%;
    
    /* 卡片 */
    --card: 0 0% 10%;
    --card-foreground: 0 0% 100%;
    
    --popover: 0 0% 10%;
    --popover-foreground: 0 0% 100%;
    
    /* Apple 深色模式蓝 #0A84FF */
    --primary: 211 100% 52%;
    --primary-foreground: 0 0% 100%;
    --primary-hover: 211 100% 58%;
    
    --secondary: 0 0% 15%;
    --secondary-foreground: 0 0% 90%;
    
    --muted: 0 0% 15%;
    --muted-foreground: 0 0% 55%;
    
    --accent: 0 0% 15%;
    --accent-foreground: 0 0% 90%;
    
    /* Apple 深色模式红 #FF453A */
    --destructive: 4 100% 62%;
    --destructive-foreground: 0 0% 100%;
    
    /* Apple 深色模式绿 #30D158 */
    --success: 142 72% 51%;
    --success-foreground: 0 0% 100%;
    
    /* Apple 深色模式橙 #FF9F0A */
    --warning: 37 100% 52%;
    --warning-foreground: 0 0% 0%;
    
    /* 边框 */
    --border: 0 0% 18%;
    --border-secondary: 0 0% 22%;
    --input: 0 0% 18%;
    --ring: 211 100% 52%;
    
    /* 侧边栏 */
    --sidebar: 0 0% 7%;
    --sidebar-foreground: 0 0% 100%;
    --sidebar-border: 0 0% 18%;
    --sidebar-accent: 211 100% 52%;
    --sidebar-accent-foreground: 0 0% 100%;
    --sidebar-muted: 0 0% 55%;
    
    /* 标题栏 */
    --titlebar: 0 0% 7%;
    --titlebar-foreground: 0 0% 100%;
    --titlebar-border: 0 0% 18%;
    
    /* 深色阴影 */
    --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.2);
    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
    --shadow: 0 2px 8px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.2);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.5), 0 2px 4px rgba(0, 0, 0, 0.2);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.6), 0 4px 8px rgba(0, 0, 0, 0.2);
    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.7), 0 8px 16px rgba(0, 0, 0, 0.2);
    
    /* 深色玻璃态 */
    --glass-bg: rgba(28, 28, 30, 0.72);
    --glass-border: rgba(255, 255, 255, 0.1);
  }
}

/* ===== Apple 主题色彩变体 ===== */

/* 默认蓝色主题 */
:root.theme-default {
  --primary: 221.2 83.2% 53.3%;
  --primary-foreground: 0 0% 100%;
  --ring: 221.2 83.2% 53.3%;
}
.dark.theme-default {
  --primary: 217.2 91.2% 59.8%;
  --primary-foreground: 0 0% 100%;
  --ring: 217.2 91.2% 59.8%;
}

/* 紫色主题 */
:root.theme-purple {
  --primary: 262.1 83.3% 57.8%;
  --primary-foreground: 0 0% 100%;
  --ring: 262.1 83.3% 57.8%;
}
.dark.theme-purple {
  --primary: 263.4 70% 65%;
  --primary-foreground: 0 0% 100%;
  --ring: 263.4 70% 65%;
}

/* 绿色主题 */
:root.theme-green {
  --primary: 160.1 84.1% 39.4%;
  --primary-foreground: 0 0% 100%;
  --ring: 160.1 84.1% 39.4%;
}
.dark.theme-green {
  --primary: 158.1 64.4% 51.6%;
  --primary-foreground: 0 0% 0%;
  --ring: 158.1 64.4% 51.6%;
}

/* 橙色主题 */
:root.theme-orange {
  --primary: 24.6 95% 53.1%;
  --primary-foreground: 0 0% 100%;
  --ring: 24.6 95% 53.1%;
}
.dark.theme-orange {
  --primary: 20.5 90.2% 56.1%;
  --primary-foreground: 0 0% 0%;
  --ring: 20.5 90.2% 56.1%;
}

/* 玫瑰色主题 */
:root.theme-rose {
  --primary: 350.4 89.2% 60.2%;
  --primary-foreground: 0 0% 100%;
  --ring: 350.4 89.2% 60.2%;
}
.dark.theme-rose {
  --primary: 346.8 77.2% 64%;
  --primary-foreground: 0 0% 100%;
  --ring: 346.8 77.2% 64%;
}

/* 石板灰主题 */
:root.theme-slate {
  --primary: 215.4 16.3% 46.9%;
  --primary-foreground: 0 0% 100%;
  --ring: 215.4 16.3% 46.9%;
}
.dark.theme-slate {
  --primary: 215.3 19.3% 55%;
  --primary-foreground: 0 0% 100%;
  --ring: 215.3 19.3% 55%;
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    font-family: var(--font-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
    overscroll-behavior: none;
    scroll-behavior: smooth;
    /* 缩放相关 - 高度由 JS 动态设置 */
    height: 100%;
    min-height: 100vh;
    overflow-x: hidden;
    overflow-y: auto;
  }

  body {
    @apply bg-background text-foreground;
    -webkit-tap-highlight-color: transparent;
    text-size-adjust: 100%;
    line-height: 1.5;
    letter-spacing: -0.012em;
    font-size: 16px;
    /* 确保 body 至少填满视口 */
    min-height: 100%;
    transition: background-color var(--duration-normal) var(--ease-default),
                color var(--duration-normal) var(--ease-default);
  }

  /* Apple 风格文字选择 */
  ::selection {
    background: hsl(var(--primary) / 0.2);
    color: inherit;
  }

  /* 安全区域适配 - iOS */
  .safe-area-top { padding-top: env(safe-area-inset-top); }
  .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
  .safe-area-left { padding-left: env(safe-area-inset-left); }
  .safe-area-right { padding-right: env(safe-area-inset-right); }

  /* Zed + Apple 混合排版系统 */
  /* 基于 Zed 的 16px UI 字体基准，优化可读性 */

  h1, .text-title-1 {
    font-size: 28px;
    font-weight: 700;
    line-height: 1.15;
    letter-spacing: -0.01em;
  }

  h2, .text-title-2 {
    font-size: 22px;
    font-weight: 600;
    line-height: 1.25;
    letter-spacing: -0.008em;
  }

  h3, .text-title-3 {
    font-size: 20px;
    font-weight: 600;
    line-height: 1.3;
    letter-spacing: -0.008em;
  }

  .text-headline {
    font-size: 17px;
    font-weight: 600;
    line-height: 1.35;
    letter-spacing: -0.016em;
  }

  .text-body {
    font-size: 16px;
    font-weight: 400;
    line-height: 1.5;
    letter-spacing: -0.012em;
  }

  .text-callout {
    font-size: 15px;
    font-weight: 400;
    line-height: 1.45;
    letter-spacing: -0.012em;
  }

  .text-subheadline {
    font-size: 14px;
    font-weight: 400;
    line-height: 1.4;
    letter-spacing: -0.008em;
  }

  .text-footnote {
    font-size: 13px;
    font-weight: 400;
    line-height: 1.4;
    letter-spacing: -0.004em;
  }

  .text-caption-1 {
    font-size: 12px;
    font-weight: 400;
    line-height: 1.35;
    letter-spacing: 0;
  }

  .text-caption-2 {
    font-size: 11px;
    font-weight: 400;
    line-height: 1.3;
    letter-spacing: 0.004em;
  }
}

@layer components {
  /* ===== 标题栏 - macOS 风格 ===== */
  .titlebar {
    -webkit-app-region: drag;
    app-region: drag;
    background: hsl(var(--titlebar));
    border-bottom: 0.5px solid hsl(var(--titlebar-border));
  }

  .titlebar button,
  .titlebar-no-drag {
    -webkit-app-region: no-drag;
    app-region: no-drag;
  }

  /* ===== Apple 风格滚动条 ===== */
  .scrollbar-apple {
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--foreground) / 0.15) transparent;
  }

  .scrollbar-apple::-webkit-scrollbar {
    width: 0.5rem;
    height: 0.5rem;
  }

  .scrollbar-apple::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-apple::-webkit-scrollbar-thumb {
    background-color: hsl(var(--foreground) / 0.15);
    border-radius: 100px;
    border: 2px solid transparent;
    background-clip: content-box;
  }

  .scrollbar-apple::-webkit-scrollbar-thumb:hover {
    background-color: hsl(var(--foreground) / 0.25);
  }

  .scrollbar-apple::-webkit-scrollbar-corner {
    background: transparent;
  }

  /* 隐藏滚动条 */
  .scrollbar-none {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-none::-webkit-scrollbar {
    display: none;
  }

  /* ===== 侧边栏 - Zed + Apple 风格 ===== */
  .sidebar {
    background-color: hsl(var(--sidebar));
    color: hsl(var(--sidebar-foreground));
  }

  .sidebar-item {
    @apply relative flex items-center gap-2.5 px-3 py-2 rounded-md cursor-pointer;
    @apply text-[0.875rem] font-normal;
    color: hsl(var(--sidebar-foreground));
    transition: all var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
    min-height: 2.25rem;
  }

  .sidebar-item:hover {
    background: hsl(var(--foreground) / 0.05);
  }

  .sidebar-item:active {
    background: hsl(var(--foreground) / 0.08);
    transform: scale(0.98);
  }

  .sidebar-item.active {
    background: hsl(var(--primary) / 0.15);
    color: hsl(var(--primary));
    font-weight: 500;
  }

  .sidebar-item.active:hover {
    background: hsl(var(--primary) / 0.18);
  }

  /* ===== Apple 毛玻璃效果 ===== */
  .glass {
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
  }

  .glass-thin {
    background: hsl(var(--background) / 0.6);
    backdrop-filter: blur(10px) saturate(150%);
    -webkit-backdrop-filter: blur(10px) saturate(150%);
  }

  .glass-thick {
    background: hsl(var(--background) / 0.85);
    backdrop-filter: blur(30px) saturate(200%);
    -webkit-backdrop-filter: blur(30px) saturate(200%);
  }

  .glass-ultra {
    background: hsl(var(--background) / 0.5);
    backdrop-filter: blur(40px) saturate(200%);
    -webkit-backdrop-filter: blur(40px) saturate(200%);
  }

  /* ===== Apple 风格卡片 ===== */
  .card-apple {
    @apply bg-card rounded-xl;
    box-shadow: var(--shadow-sm);
    border: 0.5px solid hsl(var(--border));
    transition: all var(--duration-normal) var(--ease-default);
  }

  .card-apple:hover {
    box-shadow: var(--shadow-md);
  }

  .card-elevated {
    @apply bg-card rounded-xl;
    box-shadow: var(--shadow-lg);
  }

  .card-grouped {
    @apply bg-card rounded-xl overflow-hidden;
    box-shadow: var(--shadow-xs);
    border: 0.5px solid hsl(var(--border));
  }

  .card-grouped > * + * {
    border-top: 0.5px solid hsl(var(--border));
  }

  /* ===== Zed + Apple 风格列表 ===== */
  .list-item-apple {
    @apply flex items-center justify-between px-4 py-2.5;
    min-height: 2.5rem;
    transition: background var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
  }

  .list-item-apple:active {
    background: hsl(var(--foreground) / 0.05);
  }

  .list-inset {
    @apply mx-4 rounded-xl overflow-hidden;
    background: hsl(var(--card));
    box-shadow: var(--shadow-xs);
    border: 0.5px solid hsl(var(--border));
  }

  .list-inset > * + * {
    border-top: 0.5px solid hsl(var(--border));
    margin-left: 16px;
  }

  /* ===== Zed + Apple 风格按钮 ===== */
  .btn-apple {
    @apply inline-flex items-center justify-center font-medium;
    border-radius: var(--radius);
    font-size: 0.9375rem;
    height: 2.5rem;
    padding: 0 1rem;
    transition: all var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
  }

  .btn-apple:active {
    transform: scale(0.97);
    opacity: 0.9;
  }

  .btn-apple-primary {
    @apply btn-apple bg-primary text-primary-foreground;
  }

  .btn-apple-primary:hover {
    background: hsl(var(--primary-hover));
  }

  .btn-apple-secondary {
    @apply btn-apple;
    background: hsl(var(--primary) / 0.12);
    color: hsl(var(--primary));
  }

  .btn-apple-secondary:hover {
    background: hsl(var(--primary) / 0.18);
  }

  .btn-apple-tertiary {
    @apply btn-apple;
    background: transparent;
    color: hsl(var(--primary));
  }

  .btn-apple-tertiary:hover {
    background: hsl(var(--primary) / 0.08);
  }

  .btn-apple-destructive {
    @apply btn-apple;
    background: hsl(var(--destructive) / 0.12);
    color: hsl(var(--destructive));
  }

  .btn-apple-destructive:hover {
    background: hsl(var(--destructive) / 0.18);
  }

  /* ===== Zed + Apple 风格输入框 ===== */
  .input-apple {
    @apply w-full px-3.5 py-2.5 rounded-lg;
    font-size: 0.9375rem;
    background: hsl(var(--secondary));
    border: none;
    outline: none;
    transition: all var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
  }

  .input-apple:focus {
    box-shadow: 0 0 0 0.1875rem hsl(var(--primary) / 0.15);
  }

  .input-apple::placeholder {
    color: hsl(var(--muted-foreground));
  }

  /* 带边框的输入框 */
  .input-apple-bordered {
    @apply w-full px-3.5 py-2.5 rounded-lg;
    font-size: 0.9375rem;
    background: hsl(var(--background));
    border: 0.0625rem solid hsl(var(--border));
    outline: none;
    transition: all var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
  }

  .input-apple-bordered:focus {
    border-color: hsl(var(--primary));
    box-shadow: 0 0 0 0.1875rem hsl(var(--primary) / 0.1);
  }

  /* 搜索框 */
  .search-apple {
    @apply relative flex items-center;
  }

  .search-apple input {
    @apply w-full pl-9 pr-3.5 py-2 rounded-md;
    font-size: 0.9375rem;
    background: hsl(var(--secondary));
    border: none;
    outline: none;
    letter-spacing: -0.008em;
  }

  .search-apple input:focus {
    box-shadow: 0 0 0 0.1875rem hsl(var(--primary) / 0.15);
  }

  .search-apple .search-icon {
    @apply absolute left-3;
    color: hsl(var(--muted-foreground));
  }

  /* ===== Apple 风格分割线 ===== */
  .divider-apple {
    height: 0.03125rem;
    background: hsl(var(--border));
  }

  .divider-inset {
    height: 0.03125rem;
    background: hsl(var(--border));
    margin-left: 1rem;
  }

  /* ===== Zed + Apple 聊天气泡 ===== */
  .chat-bubble {
    @apply relative px-3.5 py-2.5;
    max-width: min(85%, 26.25rem);
    font-size: 0.9375rem;
    line-height: 1.5;
    word-wrap: break-word;
    letter-spacing: -0.008em;
  }

  .chat-bubble-user {
    @apply bg-primary text-primary-foreground;
    border-radius: 1rem 1rem 0.25rem 1rem;
  }

  .chat-bubble-assistant {
    background: hsl(var(--secondary));
    color: hsl(var(--foreground));
    border-radius: 1rem 1rem 1rem 0.25rem;
  }

  /* 连续消息圆角调整 */
  .chat-bubble-user.continuous-top {
    border-radius: 18px 4px 4px 18px;
  }

  .chat-bubble-user.continuous-bottom {
    border-radius: 18px 18px 4px 4px;
  }

  .chat-bubble-assistant.continuous-top {
    border-radius: 4px 18px 18px 4px;
  }

  .chat-bubble-assistant.continuous-bottom {
    border-radius: 18px 18px 18px 4px;
  }

  /* ===== Apple 开关样式 ===== */
  .switch-apple {
    @apply relative inline-flex h-[31px] w-[51px] shrink-0 cursor-pointer items-center rounded-full;
    background: hsl(var(--muted-foreground) / 0.3);
    transition: background var(--duration-normal) var(--ease-default);
  }

  .switch-apple[data-state="checked"] {
    background: hsl(var(--success));
  }

  .switch-apple-thumb {
    @apply block h-[27px] w-[27px] rounded-full bg-white;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.15), 0 0.0625rem 0.0625rem rgba(0, 0, 0, 0.1);
    transform: translateX(0.125rem);
    transition: transform var(--duration-normal) var(--ease-spring);
  }

  .switch-apple[data-state="checked"] .switch-apple-thumb {
    transform: translateX(1.375rem);
  }

  /* ===== Apple 分段控件 ===== */
  .segment-apple {
    @apply inline-flex p-0.5 rounded-lg;
    background: hsl(var(--secondary));
  }

  .segment-apple-item {
    @apply px-4 py-1.5 rounded-md text-sm font-medium;
    color: hsl(var(--foreground));
    transition: all var(--duration-fast) var(--ease-default);
  }

  .segment-apple-item:hover {
    color: hsl(var(--foreground));
  }

  .segment-apple-item.active {
    background: hsl(var(--background));
    box-shadow: var(--shadow-sm);
  }

  /* ===== Zed + Apple 风格徽章 ===== */
  .badge-apple {
    @apply inline-flex items-center justify-center px-2 py-0.5 rounded-full;
    font-size: 0.6875rem;
    font-weight: 600;
    min-width: 1.125rem;
    height: 1.125rem;
    letter-spacing: 0;
  }

  .badge-apple-primary {
    @apply badge-apple bg-primary text-primary-foreground;
  }

  .badge-apple-destructive {
    @apply badge-apple bg-destructive text-destructive-foreground;
  }

  .badge-apple-muted {
    @apply badge-apple;
    background: hsl(var(--muted));
    color: hsl(var(--muted-foreground));
  }

  /* ===== Apple 进度条 ===== */
  .progress-apple {
    @apply w-full h-1 rounded-full overflow-hidden;
    background: hsl(var(--secondary));
  }

  .progress-apple-bar {
    @apply h-full rounded-full;
    background: hsl(var(--primary));
    transition: width var(--duration-slow) var(--ease-out);
  }

  /* ===== Apple 加载指示器 ===== */
  .spinner-apple {
    @apply relative;
    width: 1.25rem;
    height: 1.25rem;
  }

  .spinner-apple::before {
    content: '';
    @apply absolute inset-0 rounded-full;
    border: 0.125rem solid hsl(var(--foreground) / 0.1);
    border-top-color: hsl(var(--primary));
    animation: spin 0.8s linear infinite;
  }

  /* ===== Apple 骨架屏 ===== */
  .skeleton-apple {
    @apply rounded-lg;
    background: linear-gradient(
      90deg,
      hsl(var(--muted)) 0%,
      hsl(var(--muted-foreground) / 0.08) 50%,
      hsl(var(--muted)) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
  }

  /* ===== Zed + Apple 风格工具提示 ===== */
  .tooltip-apple {
    @apply px-2.5 py-1.5 rounded-md;
    font-size: 0.75rem;
    font-weight: 500;
    background: hsl(var(--foreground));
    color: hsl(var(--background));
    box-shadow: var(--shadow-md);
    letter-spacing: -0.004em;
  }

  /* ===== Zed + Apple 风格弹出菜单 ===== */
  .menu-apple {
    @apply rounded-lg overflow-hidden py-1;
    background: hsl(var(--popover));
    box-shadow: var(--shadow-lg);
    border: 0.03125rem solid hsl(var(--border));
    min-width: 12.5rem;
  }

  .menu-apple-item {
    @apply flex items-center gap-2.5 px-3.5 py-2 cursor-pointer;
    font-size: 0.875rem;
    transition: background var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
    min-height: 2.25rem;
  }

  .menu-apple-item:hover {
    background: hsl(var(--primary) / 0.1);
  }

  .menu-apple-item:active {
    background: hsl(var(--primary) / 0.15);
  }

  .menu-apple-separator {
    height: 0.03125rem;
    background: hsl(var(--border));
    margin: 0.25rem 0;
  }

  /* ===== Zed + Apple 风格模态框 ===== */
  .modal-apple-overlay {
    @apply fixed inset-0;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(0.25rem);
    -webkit-backdrop-filter: blur(0.25rem);
  }

  .modal-apple {
    @apply rounded-2xl overflow-hidden;
    background: hsl(var(--card));
    box-shadow: var(--shadow-xl);
    max-width: 90vw;
    max-height: 90vh;
  }

  .modal-apple-header {
    @apply flex items-center justify-between px-5 py-3.5;
    border-bottom: 0.03125rem solid hsl(var(--border));
    min-height: 3.25rem;
  }

  .modal-apple-body {
    @apply px-5 py-4;
    font-size: 0.9375rem;
    line-height: 1.5;
    letter-spacing: -0.008em;
  }

  .modal-apple-footer {
    @apply flex items-center justify-end gap-3 px-5 py-3.5;
    border-top: 0.03125rem solid hsl(var(--border));
    min-height: 3.25rem;
  }

  /* ===== Zed + Apple 风格 Action Sheet ===== */
  .action-sheet-apple {
    @apply fixed bottom-0 left-0 right-0 p-2;
  }

  .action-sheet-apple-content {
    @apply rounded-2xl overflow-hidden;
    background: hsl(var(--card) / 0.95);
    backdrop-filter: blur(2.5rem) saturate(200%);
    -webkit-backdrop-filter: blur(2.5rem) saturate(200%);
  }

  .action-sheet-apple-item {
    @apply flex items-center justify-center py-3.5;
    font-size: 1.0625rem;
    font-weight: 400;
    color: hsl(var(--primary));
    transition: background var(--duration-fast) var(--ease-default);
    letter-spacing: -0.008em;
    min-height: 3rem;
  }

  .action-sheet-apple-item:active {
    background: hsl(var(--foreground) / 0.08);
  }

  .action-sheet-apple-item.destructive {
    color: hsl(var(--destructive));
  }

  .action-sheet-apple-cancel {
    @apply mt-2 rounded-2xl overflow-hidden;
    background: hsl(var(--card));
  }

  .action-sheet-apple-cancel-btn {
    @apply flex items-center justify-center py-3.5;
    font-size: 1.0625rem;
    font-weight: 600;
    color: hsl(var(--primary));
    letter-spacing: -0.008em;
    min-height: 3rem;
  }
}

@layer utilities {
  /* ===== 文字截断 ===== */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* ===== Apple 动画关键帧 ===== */
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  @keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes fade-out {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  @keyframes scale-in {
    from { 
      opacity: 0;
      transform: scale(0.95);
    }
    to { 
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes scale-out {
    from { 
      opacity: 1;
      transform: scale(1);
    }
    to { 
      opacity: 0;
      transform: scale(0.95);
    }
  }

  @keyframes slide-up {
    from { 
      opacity: 0;
      transform: translateY(10px);
    }
    to { 
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-down {
    from { 
      opacity: 0;
      transform: translateY(-10px);
    }
    to { 
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-in-from-bottom {
    from { 
      opacity: 0;
      transform: translateY(100%);
    }
    to { 
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-out-to-bottom {
    from { 
      opacity: 1;
      transform: translateY(0);
    }
    to { 
      opacity: 0;
      transform: translateY(100%);
    }
  }

  @keyframes bounce-in {
    0% {
      opacity: 0;
      transform: scale(0.3);
    }
    50% {
      transform: scale(1.05);
    }
    70% {
      transform: scale(0.9);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  @keyframes typing-dot {
    0%, 60%, 100% { 
      transform: translateY(0);
      opacity: 0.4;
    }
    30% { 
      transform: translateY(-4px);
      opacity: 1;
    }
  }

  /* ===== 动画类 ===== */
  .animate-fade-in {
    animation: fade-in var(--duration-normal) var(--ease-out);
  }

  .animate-fade-out {
    animation: fade-out var(--duration-fast) var(--ease-in);
  }

  .animate-scale-in {
    animation: scale-in var(--duration-normal) var(--ease-spring);
  }

  .animate-scale-out {
    animation: scale-out var(--duration-fast) var(--ease-in);
  }

  .animate-slide-up {
    animation: slide-up var(--duration-normal) var(--ease-out);
  }

  .animate-slide-down {
    animation: slide-down var(--duration-normal) var(--ease-out);
  }

  .animate-slide-in-bottom {
    animation: slide-in-from-bottom var(--duration-slow) var(--ease-spring);
  }

  .animate-slide-out-bottom {
    animation: slide-out-to-bottom var(--duration-normal) var(--ease-in);
  }

  .animate-bounce-in {
    animation: bounce-in 0.5s var(--ease-default);
  }

  .animate-pulse {
    animation: pulse 2s var(--ease-in-out) infinite;
  }

  .animate-spin {
    animation: spin 1s linear infinite;
  }

  /* 打字动画指示器 */
  .typing-indicator {
    @apply flex items-center gap-1;
  }

  .typing-indicator span {
    @apply w-2 h-2 rounded-full bg-current;
    animation: typing-dot 1.4s infinite;
  }

  .typing-indicator span:nth-child(2) {
    animation-delay: 0.2s;
  }

  .typing-indicator span:nth-child(3) {
    animation-delay: 0.4s;
  }

  /* ===== 交互效果 ===== */
  .hover-lift {
    transition: transform var(--duration-fast) var(--ease-default);
  }

  .hover-lift:hover {
    transform: translateY(-2px);
  }

  .hover-scale {
    transition: transform var(--duration-fast) var(--ease-default);
  }

  .hover-scale:hover {
    transform: scale(1.02);
  }

  .active-scale:active {
    transform: scale(0.97);
  }

  .active-opacity:active {
    opacity: 0.7;
  }

  /* ===== 焦点样式 - Apple 风格 ===== */
  .focus-ring {
    @apply outline-none;
    transition: box-shadow var(--duration-fast) var(--ease-default);
  }

  .focus-ring:focus-visible {
    box-shadow: 0 0 0 4px hsl(var(--primary) / 0.3);
  }

  /* ===== 禁用状态 ===== */
  .disabled-state {
    @apply opacity-50 cursor-not-allowed pointer-events-none;
  }

  /* ===== 选中状态高亮 ===== */
  .selected-highlight {
    background: hsl(var(--primary) / 0.12);
  }

  /* ===== 分隔线工具类 ===== */
  .border-hairline {
    border-width: 0.5px;
  }

  /* ===== 圆角工具类 ===== */
  .rounded-apple {
    border-radius: var(--radius-lg);
  }

  .rounded-apple-sm {
    border-radius: var(--radius);
  }

  .rounded-apple-lg {
    border-radius: var(--radius-xl);
  }

  .rounded-apple-xl {
    border-radius: var(--radius-2xl);
  }

  /* ===== 阴影工具类 ===== */
  .shadow-apple-xs { box-shadow: var(--shadow-xs); }
  .shadow-apple-sm { box-shadow: var(--shadow-sm); }
  .shadow-apple { box-shadow: var(--shadow); }
  .shadow-apple-md { box-shadow: var(--shadow-md); }
  .shadow-apple-lg { box-shadow: var(--shadow-lg); }
  .shadow-apple-xl { box-shadow: var(--shadow-xl); }
}
